# 健康管理平台

## 登入流程
### SSO登入
- 透過既有Gmail帳號進行登入
- 登入狀態自動偵測：若已在裝置登入 Gmail，系統可自動帶出帳號以快速登入

## 將網站快速加入手機主畫面
### 說明畫面
- 用戶註冊完畢後出現導引介面，引導Android以及iOS用戶進行「加入主畫面」的流程提示以及操作功能說明

## 驗證加入
### 上傳藥盒照片進行驗證
- 自動掃描並解析藥盒條碼，將藥品批號自動帶入系統
- 將一次性提供約6筆的藥品批號，驗證身份將比對此批號

### 填寫個人加入資料
- 個人資料欄位：
  - 姓名
  - 院所
  - 醟師姓名
- Email：自動填入SSO 帳號中對應的Email 地址
- 手機號碼：透過 OTP（一次性密碼）簡訊進行驗證，以提高資料安全性
- 隱私權條款同意：用戶需勾選同意並可點擊查看條款詳情
- 依照Email辨識身份：
  - 該用戶自行退出後，可以用原來帳號申請，依照Email辦識是否為同一人，並自動匯入先前紀錄
 
### 用藥提醒/回診提醒
- 建置網頁通知：依照用藥及回診時間進行網頁通知
  - 回診提醒：病患可設定回診當日提醒（系統自動於前一日再提醒一次）
  - 用藥提醒：病患可設定每月提醒一次（系統是於前三日再提醒一次）
- **新增使用者說明提醒解說畫面（嵌入影片或圖片）**

## 衛教素材
### 可上架文章
- 文字與圖片上傳：可上傳標題及配圖
- 嵌入影片：影片僅限平台內播放，病患無法取得連結進行分享
- **素材管理系統：**
  - 欄位：主要類別、次要類別、名稱、圖片、觀看次數、上架時間、下架時間、啟用、最新更新時間
  - 可設定素材上架或下架日期
  - 支援標籤分類，便於病患搜尋相關資訊
  - 可紀錄文章觀看次數
  - 可紀錄病患「喜歡」或「不喜歡」
  - **無紀錄影片觀看時長，僅能紀錄此文章之點擊次數**

## 註銷用戶
### 退出計劃功能
- 此網貝不提供病患管理後台系統
- 用戶可自行點擊「完全退出計畫/暫時退出計畫」，將自己的身份移除
- 移除身份後，病患無法再使用該帳號進行登入，若要再加入至平台，需再重新進行註冊
- 若病患使用同一組email進行帳號重新註冊，系統將自動帶入先前紀錄

## 報表服務
- 可登入後台進行下載Excel檔案，無畫面呈現
- 可篩選時間，將以月份為單位下載報表，若下載當月只會記錄到前一天的數據
- **文章數據：**
  - 欄位：文章名稱、觀看次數、上架時間、喜歡次數、不喜歡次數
- **病患數據：**
  - 當月新加入病患數（單位：人數）
  - 從專案開始後計算之總病患數量（單位：人數）
  - 從專案開始後計算已使用之藥盒條碼（單位：藥盒數）
  - 從專案開始後計算各院所之累計病患數（單位：人數）
  - 當月已退出人數（單位：人數）
  - 病患每月平均登入次數：1≤x<4次、4≤x<8次、8≤X<16次、16≤x<31次（每月30日計算一次、公式：病患次數/當月天數）（單位：人數）
  - 登入但是沒有紀錄的人（單位：%數以及人數）
  - 總登入人數幾位（單位：人數）
- 所有病患數據將不扣除已退出人數
- 更新頻率：每日更新

# RWD設計
## 桌機響應式設計
- 上述功能僅提供手機介面
  - 所有畫面皆需進行調整以符合不同裝置的大小

----
### 資料庫結構

----
### 目錄結構
health-management-api/
sql/
├── TableSchema.sql
src/
├── config/
│   │   ├── database.js      # 資料庫配置
│   │   └── config.js        # 其他配置項目
│   │
│   ├── models/              # 資料庫模型
│   │   ├── User.js         # 用戶模型
│   │   ├── HealthRecord.js # 健康記錄模型
│   │   ├── Exercise.js     # 運動記錄模型
│   │   ├── Diet.js         # 飲食記錄模型
│   │   └── index.js        # 模型整合
│   │
│   ├── routes/             # 路由配置
│   │   ├── userRoutes.js   # 用戶相關路由
│   │   ├── healthRoutes.js # 健康記錄路由
│   │   ├── exerciseRoutes.js # 運動相關路由
│   │   └── dietRoutes.js   # 飲食相關路由
│   │
│   │
│   ├── services/          # 業務邏輯
│   │   ├── userService.js
│   │   ├── healthService.js
│   │   ├── exerciseService.js
│   │   └── dietService.js
│   │
│   ├── middlewares/       # 中間件
│   │   ├── auth.js        # 認證中間件
│   │   ├── error.js       # 錯誤處理
│   │   └── validator.js   # 數據驗證
│   │
│   └── utils/            # 工具函數
│       ├── ApiError.js   # API錯誤類
│       └── logger.js     # 日誌工具
│
├── app.js              # 應用入口文件
├── .env                  # 環境變數
├── .gitignore           # Git忽略文件
├── package.json         # 項目依賴
├── sketch.md            # 項目筆記
└── README.md            # 項目說明